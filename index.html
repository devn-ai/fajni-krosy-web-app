<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Telegram WebApp</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background: #f7f7f7; margin: 0; padding: 40px;}
    .card { background: #fff; border-radius: 12px; box-shadow: 0 3px 12px rgba(0,0,0,0.08); max-width: 320px; margin: 0 auto; padding: 32px;}
    button { background: #229ED9; color: #fff; border: none; padding: 12px 22px; border-radius: 8px; font-size: 16px; cursor: pointer;}
  </style>
</head>
<body>
<div id="product-catalog"></div>

  <div class="cart">
    <h2>Кошик</h2>
    <ul id="cart-list"></ul>
    <form id="checkout-form">
        <input name="name" type="text" placeholder="Ваше ім'я" required>
        <input name="phone" type="text" placeholder="Телефон" required>
        <input name="shoes" type="text" placeholder="Взуття" required>
        <button type="submit">Відправити замовлення</button>
    </form>
  </div>
</body>
  <script>
fetch('db.json')
  .then(response => response.json())
  .then(products => {
    const catalog = document.getElementById('product-catalog');
    products.forEach(product => {
      const card = document.createElement('div');
      card.className = 'product-card';
      card.innerHTML = `
        <h2>${product.brand} ${product.model}</h2>
        <div class="color-label">Колір: ${product.color}</div>
        <div class="product-price">${product.price} грн</div>
        <select class="size-select">
          ${product.variants.map(v => `<option value="${v.id}">${v.size}</option>`).join('')}
        </select>
        <button onclick="addToCart(this)">Замовити</button>
      `;
      catalog.appendChild(card);
    });
  });

function addToCart(button) {
  const card = button.closest('.product-card');
  const sizeSelect = card.querySelector('.size-select');
  const variantId = sizeSelect.value;
  // Тут можна реалізувати додавання до кошика у ваш json чи localStorage
  alert(`Додано до кошика товар з id: ${variantId}`);
}
</script>

  <script>

renderCart();
document.getElementById('checkout-form').onsubmit = function(e) {
  e.preventDefault();
  const webhookUrl = "https://hook.eu2.make.com/1ettzvhwvhnmag3f5otfig2ospqw2nd9"; 
  const form = e.target;
  const order = {
    name: form.name.value,
    phone: form.phone.value,
    shoes: form.shoes.value,
    cart: cart
  };

  fetch(webhookUrl, {
    method: "POST",
    body: JSON.stringify(order),
    headers: {"Content-Type": "application/json"}
  }).then(res => {
    if (res.ok) {
      window.Telegram.WebApp.close();
      alert("Дякуємо за замовлення!");
    }
  });
};

  </script>
</html>
